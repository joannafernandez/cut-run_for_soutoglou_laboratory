singularity {
    enabled = true
    cacheDir = "$HOME/.singularity/cache"
}

process {
    executor = 'slurm'

    // Default partition and resources
    queue  = 'general'      // or 'long' if you prefer long-running jobs
    cpus   = 4
    memory = '16 GB'
    time   = '4h'           // default per-process, safely < 8h limit

    // Trim Galore + FastQC are usually quick and light
    withName: 'NFCORE_CUTANDRUN:CUTANDRUN:FASTQC_TRIMGALORE:TRIMGALORE.*' {
        time = '2h'
        cpus = 2
        memory = '8 GB'
    }

    // Bowtie2 alignment – likes more threads & RAM
    withName: '.*BOWTIE2_ALIGN.*' {
        cpus   = 8
        memory = '32 GB'
        time   = '6h'   // still under 8h general limit
    }

    // deepTools: computeMatrix / plotHeatmap / plotProfile / bigwig utilities
    // Names are broad on purpose to catch deeptools modules in the workflow
    withName: '.*DEEPPLOTS.*' {
        cpus   = 8
        memory = '32 GB'
        time   = '6h'
    }
    withName: '.*DEEPTOOLS.*' {
        cpus   = 8
        memory = '32 GB'
        time   = '6h'
    }
    withName: '.*COMPUTEMATRIX.*' {
        cpus   = 8
        memory = '32 GB'
        time   = '6h'
    }
    withName: '.*PLOTHEATMAP.*' {
        cpus   = 8
        memory = '32 GB'
        time   = '6h'
    }
    withName: '.*PLOTPROFILE.*' {
        cpus   = 8
        memory = '32 GB'
        time   = '6h'
    }
}

// Global nf-core limits – must respect partition limits
params {
    max_memory = '64.GB'
    max_cpus   = 16
    max_time   = '8.h'      // NEVER more than 8h on 'general'
}
